<h1>
    {{ group }}

    <small class="pull-right-h1 black">
        {{ failed.total }}
        <small>Jobs</small>
    </small>
</h1>

<div class="row">
    <div class="btn-group pull-right" role="group">
        <button ng-click="on_retry_all()" type="button" class="btn btn-sm btn-success">
            <span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>
            Retry All
        </button>

        <button ng-click="on_cancel_all()" type="button" class="btn btn-sm btn-danger">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            Cancel All
        </button>
    </div>

    <nav>
        <ul class="pagination">
            <li class="{{start == 0 ? 'disabled' : ''}}">
                <a ng-click="on_previous()" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            <li ng-repeat="page in pages" class="{{start == page ? 'active' : ''}}">
                <a ng-click="on_select_page(page)">
                    {{ $index+1 }}
                </a>
            </li>

            <li class="{{limit >= failed.total ? 'disabled' : ''}}">
                <a ng-click="on_next()" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

<div ng-switch on="failed.jobs.length">
    <div ng-switch-when="0">
        Nothing to see here, move along.
    </div>

    <table ng-switch-default class="table table-striped table-hover">
        <thead>
        <tr>
            <th>jid</th>
            <th>error</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="job in failed.jobs">
            <td>
                <strong>{{job.klass_name}}</strong> <br>
                <a href="#/jobs/{{ job.jid }}">{{ job.jid }}</a>

            </td>
            <td>
                <div class="alert alert-danger" role="alert">
                    In <strong>{{job.queue_name}}</strong>
                    on <strong>{{job.failure.worker}}</strong>
                    <em>{{moment.unix(job.failure.when).format()}}</em>
                    ({{moment.unix(job.failure.when).fromNow()}})

                    <pre>{{ job.failure.message }}</pre>
                </div>
            </td>
            <td>
                <div class="btn-group pull-right" role="group">
                    <button ng-click="on_retry(job.jid)" type="button" class="btn btn-xs btn-success">
                        <span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>
                    </button>

                    <button ng-click="on_cancel(job.jid)" type="button" class="btn btn-xs btn-danger">
                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                    </button>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<nav>
    <ul class="pagination">
        <li class="{{start == 0 ? 'disabled' : ''}}">
            <a ng-click="on_previous()" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>

        <li ng-repeat="page in pages" class="{{start == page ? 'active' : ''}}">
            <a ng-click="on_select_page(page)">
                {{ $index+1 }}
            </a>
        </li>

        <li class="{{limit >= failed.total ? 'disabled' : ''}}">
            <a ng-click="on_next()" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
    <p>
        Showing failed job <strong>{{start+1}}</strong> to <strong>{{limit}}</strong> of total <strong>{{failed.total}}</strong>.
    </p>
</nav>

<pre>
{{failed}}
</pre>